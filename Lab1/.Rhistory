install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
install.packages("flextable")
knitr::opts_chunk$set(echo = TRUE)
library(stargazer)
library(stringr)
library(tidyverse)
library(dplyr)
library(flextable)
library(magrittr)
#test table
cols_to_plot[1] %>% autofit() %>%
width(j=~knitter_path, width = 1) %>% width(j=~binomial, width = 1) %>% width(j=~m, width = 1)
library(kableExtra)
library(flextable)
library(magrittr)
library(kableExtra)
#test table
cols_to_plot[1] %>% autofit() %>%
width(j=~knitter_path, width = 1) %>% width(j=~binomial, width = 1) %>% width(j=~m, width = 1)
knitr::kable(cols_to_plot[1], "html") %>%
kable_styling(full_width = F)
knitr::opts_chunk$set(echo = TRUE)
library(stargazer)
library(stringr)
library(tidyverse)
library(dplyr)
library(flextable)
library(magrittr)
library(kableExtra)
knitr::kable(cols_to_plot[1], format = "html", tabble.attr = "style='width:30%;'")
library(stargazer)
library(stringr)
library(tidyverse)
library(dplyr)
library(flextable)
library(magrittr)
library(kableExtra)
setwd("~/Dropbox/ICB_Chaet_paper_2019")
#read in adjacency statistics
adj_stats_path <- "/Users/shawn/Dropbox/ICB_Chaet_paper_2019/appendix_tables/fish_adjacency_stats_table_roa-mod.csv"
adj_stats<- read.table(adj_stats_path, sep = ",", header=T, as.is=F)
adj_stats$name <- as.character(adj_stats$name)
#need to create a new column that is just the genus_species for table
str_split(adj_stats$name, "_")
adj_stats %>% separate(name, c(NA, "genus", "species", NA),sep = "_", remove = F) ->adj_stats
adj_stats$genus <- substr(adj_stats$genus, 0, 1)
adj_stats$binomial <- paste(adj_stats$genus, adj_stats$species, sep="_")
image_paths <- str_c("/Users/shawn/Dropbox/ICB_Chaet_paper_2019/images/curated_images/", adj_stats$name, ".png")
adj_stats$image_paths <- image_paths
knitter_path <- sprintf('![](%s){width=25%%}', image_paths)
adj_stats$knitter_path <-  knitter_path
names(adj_stats)[2] <- "Full.Genus"
names(adj_stats)[5] <- "ID"
select(adj_stats, knitter_path, binomial,m) %>% arrange(desc(m)) -> m_sorted
select(adj_stats, knitter_path, binomial,A) %>% arrange(desc(A)) -> A_sorted
select(adj_stats, knitter_path, binomial,Jc) %>% arrange(desc(Jc)) -> Jc_sorted
select(adj_stats, knitter_path, binomial,Jt) %>% arrange(desc(Jt)) -> Jt_sorted
select(adj_stats, knitter_path, binomial,m_dS) %>% arrange(desc(m_dS)) -> mS_sorted
select(adj_stats, knitter_path, binomial, m_dL) %>% arrange(desc(m_dL)) -> mL_sorted
bind_cols(m_sorted, A_sorted, Jc_sorted, Jt_sorted) -> sorted_patterns
cols_to_plot <- list(m_sorted, A_sorted, Jc_sorted, Jt_sorted, mS_sorted, mL_sorted)
knitr::kable(cols_to_plot[1], format = "html", tabble.attr = "style='width:30%;'")
#clean up workspace
rm(list=ls())
#includes
library(phytools)
library(ggtree)
library(ggimage)
#define dir paths
resources_path <- "~/Developer/EEB-C174-Labs/Lab1/resources/"
output_path <- "output/"
#set working directory
setwd("~/Developer/EEB-C174-Labs/Lab1")
#read in fish tree (Rabosky et al. 2019)
fish_megatree <- read.tree(c(resources_path,"fish.tre"))
#read in fish tree (Rabosky et al. 2019)
fish_megatree <- read.tree(paste(resources_path,"fish.tre"))
#read in fish tree (Rabosky et al. 2019)
fish_megatree <- read.tree(paste0(resources_path,"fish.tre"))
#prep large tree for visualization
fish_megatree <- ladderize(fish_megatree)
plot(fish_megatree)
plot(fish_megatree, cex = 0.2)
fish_megatree
library(tidyr)
##split tip labels into Genus, species
separate(data = fish_megatree, col = tip.label, into = c("Genus", "species"), sep = "_")
fish_megatree$tip.label
test <- fish_megatree$tip.label
##split tip labels into Genus, species
separate(data = fish_megatree, col = tip.label, into = c("Genus", "species"), sep = "_")
##split tip labels into Genus, species
fish_megatree %>% separate(data = fish_megatree, col = tip.label, into = c("Genus", "species"), sep = "_")
##split tip labels into Genus, species
#separate(data = fish_megatree, col = tip.label, into = c("Genus", "species"), sep = "_")
zoom(fish_megatree, grep("Gambusia", fish_megatree$tip.label, cex = 0.6))
##split tip labels into Genus, species
#separate(data = fish_megatree, col = tip.label, into = c("Genus", "species"), sep = "_")
zoom(fish_megatree, grep("Gambusia", fish_megatree$tip.label), cex = 0.6)
plot(fish_megatree, cex = 0.2)
##split tip labels into Genus, species
zoom(fish_megatree, grep("Gambusia", fish_megatree$tip.label), cex = 0.6)
tiplabels()
fish_megatree$tip.label
##split tip labels into Genus, species
zoom(fish_megatree, grep("Coris", fish_megatree$tip.label), cex = 0.6)
Coris_MRCA <- getMRCA(fish_megatree, c("Coris_julis", "Coris_pictoides"))
extracted_clade_tree <- extract.clade(fish_megatree, node = Coris_MRCA)
source('~/Developer/EEB-C174-Labs/Lab1/lab_one_homework.R', echo=TRUE)
par(mar=(1,1,1,1))
par(mar=c(1,1,1,1))
plot(extracted_clade_tree)
par(mar = c(1,1,1,1))
plot(extracted_clade_tree, cex = 0.6)
par(mar=c(5.1,4.1,4.1,2.1)
par(mar=c(5.1,4.1,4.1,2.1))
plot(extracted_clade_tree, cex = 0.6)
par(mar=c(5.1,4.1,4.1,2.1))
plot(extracted_clade_tree, cex = 0.6)
par(mar = c(1,1,1,1))
plot(extracted_clade_tree, cex = 0.3)
#clean up workspace
rm(list=ls())
#includes
library(phytools)
library(ggtree)
library(ggimage)
library(tidyr)
#define dir paths
resources_path <- "~/Developer/EEB-C174-Labs/Lab1/resources/"
output_path <- "output/"
#set working directory
setwd("~/Developer/EEB-C174-Labs/Lab1")
#read in fish tree (Rabosky et al. 2019)
fish_megatree <- read.tree(paste0(resources_path,"fish.tre"))
#prep large tree for visualization
fish_megatree <- ladderize(fish_megatree)
Coris_MRCA <- getMRCA(fish_megatree, c("Coris_julis", "Coris_pictoides"))
extracted_clade_tree <- extract.clade(fish_megatree, node = Coris_MRCA)
plot(extracted_clade_tree, cex = 0.3)
##tree with tip labels and a scale bar
labrid_tree <- ggtree(extracted_clade_tree) +
geom_tiplab() +
geom_treescale(x = 20, y = 1, offset = 1) +
geom_text2(aes(subset=!isTip, label = node), hjust = -0.3, size = 3)
print(labrid_tree)
t
t
##tree with tip labels and a scale bar
labrid_tree <- ggtree(extracted_clade_tree) +
geom_tiplab() +
geom_treescale(x = 10, y = 1, offset = 1) +
geom_text2(aes(subset=!isTip, label = node), hjust = -0.3, size = 3)
print(labrid_tree)
##tree with tip labels and a scale bar
labrid_tree <- ggtree(extracted_clade_tree) +
geom_tiplab() +
geom_treescale(x = 100, y = 1, offset = 1) +
geom_text2(aes(subset=!isTip, label = node), hjust = -0.3, size = 3)
print(labrid_tree)
##tree with tip labels and a scale bar
labrid_tree <- ggtree(extracted_clade_tree) +
geom_tiplab() +
geom_treescale(x = 200, y = 1, offset = 1) +
geom_text2(aes(subset=!isTip, label = node), hjust = -0.3, size = 3)
print(labrid_tree)
##tree with tip labels and a scale bar
labrid_tree <- ggtree(extracted_clade_tree) +
geom_tiplab() +
geom_treescale(x = 50, y = 1, offset = 1) +
geom_text2(aes(subset=!isTip, label = node), hjust = -0.3, size = 3)
print(labrid_tree)
##tree with tip labels and a scale bar
labrid_tree <- ggtree(extracted_clade_tree) +
geom_tiplab() +
geom_treescale(x = 50, y = 1, offset = 1) +
geom_text2(aes(subset=!isTip, label = node), hjust = -0.3, size = 3, cex = 0.3)
##tree with tip labels and a scale bar
labrid_tree <- ggtree(extracted_clade_tree) +
geom_tiplab() +
geom_treescale(x = 50, y = 1, offset = 1) +
geom_text2(aes(subset=!isTip, label = node), hjust = -0.3, size = 2)
print(labrid_tree)
##tree with tip labels and a scale bar
labrid_tree <- ggtree(extracted_clade_tree) +
geom_tiplab() +
geom_treescale(x = 75, y = 1, offset = 1) +
geom_text2(aes(subset=!isTip, label = node), hjust = -0.3, size = 3)
print(labrid_tree)
##tree with tip labels and a scale bar
plot(extracted_clade_tree, cex = 0.4)
nodelabels()
axisPhylo()
##tree with tip labels and a scale bar
plot(extracted_clade_tree, cex = 0.1)
nodelabels()
axisPhylo()
##tree with tip labels and a scale bar
plot(extracted_clade_tree, cex = 0.2)
##tree with tip labels and a scale bar
plot(extracted_clade_tree, cex = 0.4)
axisPhylo()
nodelabels()
nodelabels(cex = 0.3)
##tree with tip labels and a scale bar
plot(extracted_clade_tree, cex = 0.4)
nodelabels(cex = 0.3)
axisPhylo()
labrid_tree <- ggtree(extracted_clade_tree) +
geom_hilight(Coris_MRCA, fill = "steelblue", alpha = 0.5)
print(labrid_tree)
##large labrid tree with phylopic
labrid_tree <- ggtree(extracted_clade_tree) +
geom_image(image = paste0(resources_path,"labrid.png"), size = Inf, alpha = 0.5, color = 'firebrick') +
ggtitle("Labridae Phylogeny")
print(labrid_tree)
##large labrid tree with phylopic
labrid_tree <- ggtree(extracted_clade_tree) +
geom_image(image = paste0(resources_path,"labrid.png"), size = Inf, alpha = 0.5, color = 'steelblue') +
ggtitle("Labridae Phylogeny")
print(labrid_tree)
pdf(paste0(output_path,"fig_1_extracted_clade.pdf"))
plot(extracted_clade_tree, cex = 0.3) #labrid tree from fish megaphylogeny
dev.off()
##tree with tip labels and a scale bar
pdf(paste0(output_path,"fig_2_extracted_tiplabs_axis.pdf"))
plot(extracted_clade_tree, cex = 0.4)
nodelabels(cex = 0.3)
axisPhylo()
dev.off()
##large labrid tree with phylopic
labrid_tree <- ggtree(extracted_clade_tree) +
geom_image(image = paste0(resources_path,"labrid.png"), size = Inf, alpha = 0.5, color = 'steelblue') +
ggtitle("Labridae Phylogeny")
pdf(paste0(output_path,"fig_4_labrid_tree.pdf"))
print(labrid_tree)
dev.off()
##zoomed tree to Coris
pdf(paste0(output_path,"fig_5extra_zoomed_tree.pdf"))
zoom(fish_megatree, grep("Coris", fish_megatree$tip.label), cex = 0.6)
dev.off()
extracted_clade_tree_data <- extracted_clade_tree$tip.label
write.tree(extracted_clade_tree, "Labrid_Tree")
write.csv(extracted_clade_tree_data, file = paste0(output_path,"Labridae_Data.csv"))
write.tree(extracted_clade_tree, paste0(output_path,"Labrid_Tree"))
#test new zoom
zoom(fish_megatree, extracted_clade_tree, cex = 0.6)
#test new zoom
zoom(fish_megatree, extracted_clade_tree, cex = 0.4)
#test new zoom
pdf(paste0(output_path,"fig_newzoomextra_zoomed_tree.pdf"))
zoom(fish_megatree, extracted_clade_tree, cex = 0.4)
dev.off()
labrid_tree
extracted_clade_tree
?zoom
#test new zoom
pdf(paste0(output_path,"fig_newzoomextra_zoomed_tree.pdf"))
zoom(fish_megatree, extracted_clade_tree$tip.label, cex = 0.4)
dev.off()
#test new zoom
pdf(paste0(output_path,"fig_newzoomextra_zoomed_tree.pdf"))
zoom(fish_megatree, extracted_clade_tree$tip.label, cex = 0.3)
dev.off()
zoom(fish_megatree, grep("Scarus", fish_megatree$tip.label), cex = 0.6)
zoom(fish_megatree, grep("Hipposcarus", fish_megatree$tip.label), cex = 0.6)
zoom(fish_megatree, grep("Chlorurus", fish_megatree$tip.label), cex = 0.6)
zoom(fish_megatree, grep("Scarus", fish_megatree$tip.label), cex = 0.6)
scarus_MRCA <- getMRCA(fish_megatree, c("Scarus_longipinnis","Scarus_compressus"))
extracted_parrotfish_tree <- extract.clade(fish_megatree, node = scarus_MRCA)
plot(extracted_parrotfish_tree)
plot(extracted_parrotfish_tree, cex = 0.6)
plot(extracted_parrotfish_tree, cex = 0.6)
plot(extracted_parrotfish_tree, cex = 0.6)
extracted_parrotfish_tree <- extract.clade(fish_megatree, node = scarus_MRCA)
plot(extracted_parrotfish_tree, cex = 0.6)
extracted_parrotfish_tree
other_tree <- read.tree(paste0(resources_path,"Labridae.tre"))
other_tree <- read.tree(paste0(output_path,"Labridae.tre"))
other_tree
other_tree <- ladderize(other_tree)
plot(other_tree)
other_tree
labrid_tre
labrid_tree
extracted_clade_tree
other_tree
other_tree
other_tree$tip.label
other_tree_MRCA <- getMRCA(other_tree, c("Halichoeres_leucurus","Lachnolaimus_maximus"))
extracted_other_tree <- extract.clade(fish_megatree, other_tree_MRCA)
extracted_other_tree <- extract.clade(other_tree, other_tree_MRCA)
extracted_other_tree
other_tree
scarus_other_MRCA <- getMRCA(fish_megatree, c("Halichoeres_leucurus","Lachnolaimus_maximus"))
new_extracted <- extract.clade(fish_megatree, node = scarus_other_MRCA)
plot(new_extracted)
plot(new_extracted, cex = 0.5)
new_extracted
new_extracted
new_extracted$tip.label
labrid_extracted_data <- labrid_extracted$tip.label
#clean up workspace
rm(list=ls())
#includes
library(phytools)
library(ggtree)
library(ggimage)
#define dir paths
resources_path <- "~/Developer/EEB-C174-Labs/Lab1/resources/"
output_path <- "output/"
#set working directory
setwd("~/Developer/EEB-C174-Labs/Lab1")
#read in fish tree (Rabosky et al. 2019)
fish_megatree <- read.tree(paste0(resources_path,"fish.tre"))
#prep large tree for visualization
fish_megatree <- ladderize(fish_megatree)
#extracted Labridae from the megaphylogeny
labrid_MRCA <- getMRCA(fish_megatree, c("Halichoeres_leucurus","Lachnolaimus_maximus"))
labrid_extracted <- extract.clade(fish_megatree, node = labrid_MRCA)
labrid_extracted_data <- labrid_extracted$tip.label
##save tree and tip labels to files
write.tree(labrid_extracted, paste0(output_path,"Labrid_Tree"))
write.csv(labrid_extracted_data, file = paste0(output_path,"Labridae_Data.csv"))
pdf(paste0(output_path,"fig_1_extracted_clade.pdf"))
plot(labrid_extracted, cex = 0.3) #labrid tree from fish megaphylogeny
dev.off()
pdf(paste0(output_path,"fig_1_extracted_clade.pdf"))
plot(labrid_extracted, cex = 0.1) #labrid tree from fish megaphylogeny
dev.off()
pdf(paste0(output_path,"fig_1_extracted_clade.pdf"))
plot(labrid_extracted, cex = 0.15) #labrid tree from fish megaphylogeny
dev.off()
pdf(paste0(output_path,"fig_1_extracted_clade.pdf"))
plot(labrid_extracted, cex = 0.1) #labrid tree from fish megaphylogeny
dev.off()
##tree with tip labels and a scale bar
pdf(paste0(output_path,"fig_2_extracted_tiplabs_axis.pdf"))
plot(labrid_extracted, cex = 0.1)
nodelabels(cex = 0.2)
axisPhylo()
dev.off()
##large labrid tree with phylopic
labrid_tree <- ggtree(labrid_extracted) +
geom_image(image = paste0(resources_path,"labrid.png"), size = Inf, alpha = 0.5, color = 'steelblue') +
ggtitle("Labridae Phylogeny")
pdf(paste0(output_path,"fig_4_labrid_tree.pdf"))
print(labrid_tree)
dev.off()
##annotate at least 2 clades on the tree with some biologically relevant information
parrot_fish_clade_scrape_feed <- extract.clade(labrid_extracted, c("Scarus_longpinnis","Scarus_compressus"))
labrid_extracted$tip.label
##annotate at least 2 clades on the tree with some biologically relevant information
parrot_fish_clade_scrape_feed <- getMRCA(labrid_extracted, tip = c("Scarus_longpinnis","Scarus_compressus"))
##annotate at least 2 clades on the tree with some biologically relevant information
parrot_fish_clade_scrape_feed <- getMRCA(labrid_extracted, c("Scarus_longpinnis","Scarus_compressus"))
##annotate at least 2 clades on the tree with some biologically relevant information
parrot_fish_clade_scrape_feed <- getMRCA(fish_megatree, c("Scarus_longpinnis","Scarus_compressus"))
##annotate at least 2 clades on the tree with some biologically relevant information
parrot_fish_clade_scrape_feed <- getMRCA(labrid_extracted, c("Scarus_longipinnis","Scarus_compressus"))
#parrot_fish_clade_seq_hermo <- extract.clade(labrid_extracted, c("Sparisoma_cretense", "Sparisoma_axillare"))
parrot_fish_clade_browse_feed <- getMRCA(labrid_extracted, c("Sparisoma_cretense", "Sparisoma_axillare"))
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrape Feeding Mode", align = T, angle = 270, hjust = 'center') +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Browsing Feeding Mode", align = T, angle = 270, hjust = 'center')
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrape Feeding Mode", align = T, angle = 270, hjust = 'center') +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsing Feeding Mode", align = T, angle = 270, hjust = 'center')
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center') +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center')
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center') +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center') +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center', cex = 0.3) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center') +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center', size = 0.3) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center') +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center', fontsize = 0.3) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center') +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center', fontsize = 2) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center') +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scraping Feeding Mode", align = T, angle = 270, hjust = 'center', fontsize = 2) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center') +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scraping Feeding Mode", align = T, angle = 270, hjust = 'center', fontsize = 2) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsing Feeding Mode", align = T, angle = 270, hjust = 'center', fontsize = 2) +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scraping Feeding", align = T, angle = 270, hjust = 'center', fontsize = 2) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsing Feeding", align = T, angle = 270, hjust = 'center', fontsize = 2) +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center', fontsize = 4) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center', fontsize = 4) +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center', fontsize = 3) +
#geom_cladelabel(node = parrot_fish_clade_seq_hermo, label = "Sequential Hermaphrodites", align = T, angle = 270, hjust = 'center')
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center', fontsize = 3) +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5)
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
##large labrid tree with phylopic
labrid_tree <- ggtree(labrid_extracted) +
geom_image(image = paste0(resources_path,"labrid.png"), size = Inf, alpha = 0.5, color = 'steelblue') +
ggtitle("Labrid Tree from Fish Megaphylogeny")
pdf(paste0(output_path,"fig_4_labrid_tree.pdf"))
print(labrid_tree)
dev.off()
##large labrid tree with phylopic
labrid_tree <- ggtree(labrid_extracted) +
geom_image(image = paste0(resources_path,"labrid.png"), size = Inf, alpha = 0.5, color = 'steelblue') +
ggtitle("Labridae Phylogeny")
pdf(paste0(output_path,"fig_4_labrid_tree.pdf"))
print(labrid_tree)
dev.off()
clade_label_labrid_tree <- ggtree(labrid_extracted) +
geom_cladelabel(node = parrot_fish_clade_scrape_feed, label = "Scrapers", align = T, angle = 270, hjust = 'center', fontsize = 3) +
geom_cladelabel(node = parrot_fish_clade_browse_feed, label = "Browsers", align = T, angle = 270, hjust = 'center', fontsize = 3) +
geom_hilight(parrot_fish_clade_scrape_feed, fill = 'firebrick', alpha = 0.5) +
geom_hilight(parrot_fish_clade_browse_feed, fill = 'darkgreen', alpha = 0.5) +
ggtitle("Labridae Phylogeny")
pdf(paste0(output_path,"fig_3_extracted_clade_labels.pdf"))
print(clade_label_labrid_tree)
dev.off()
pdf(paste0(output_path,"fig_zoomed_tree.pdf"))
zoom(fish_megatree, labrid_extracted$tip.label, cex = 0.3)
dev.off()
pdf(paste0(output_path,"fig_zoomed_tree.pdf"))
zoom(fish_megatree, labrid_extracted$tip.label, cex = 0.1)
dev.off()
##tree with tip labels and a scale bar
pdf(paste0(output_path,"fig_2_extracted_tiplabsno_axis.pdf"))
plot(labrid_extracted, cex = 0.1)
#nodelabels(cex = 0.2)
axisPhylo()
dev.off()
##tree with tip labels and a scale bar
pdf(paste0(output_path,"fig_2_extracted_tiplabsno_axis_scale.pdf"))
plot(labrid_extracted, cex = 0.1)
#nodelabels(cex = 0.2)
#axisPhylo()
add.scale.bar()
dev.off()
?add.scale.bar
